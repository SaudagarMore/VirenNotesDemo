Below is a complete, step-by-step solution to your assignment.
By the end, you will have one EC2 instance provisioned by Terraform running:

Flask backend â†’ port 5000

Express frontend â†’ port 3000

Both accessible via public IP

ğŸ§© Architecture Overview
Internet
   |
   |-- EC2 Public IP
        |-- Flask (Python)   â†’ http://<IP>:5000
        |-- Express (Node)   â†’ http://<IP>:3000

âœ… Prerequisites

On your local machine:

AWS account

IAM user with EC2 + VPC permissions

AWS CLI configured:

aws configure


Terraform installed

ğŸ“ Project Structure
terraform-flask-express/
â”‚
â”œâ”€â”€ main.tf
â”œâ”€â”€ variables.tf
â”œâ”€â”€ outputs.tf
â”œâ”€â”€ userdata.sh

ğŸ§± Step 1: Terraform Variables (variables.tf)
variable "region" {
  default = "us-east-1"
}

variable "instance_type" {
  default = "t2.micro"
}

variable "key_name" {
  description = "Your EC2 key pair name"
}

ğŸ§± Step 2: Terraform Main Configuration (main.tf)
provider "aws" {
  region = var.region
}

resource "aws_security_group" "web_sg" {
  name = "flask-express-sg"

  ingress {
    from_port   = 22
    to_port     = 22
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  ingress {
    from_port   = 3000
    to_port     = 3000
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  ingress {
    from_port   = 5000
    to_port     = 5000
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}

resource "aws_instance" "app_server" {
  ami                    = "ami-0c02fb55956c7d316" # Amazon Linux 2 (us-east-1)
  instance_type          = var.instance_type
  key_name               = var.key_name
  vpc_security_group_ids = [aws_security_group.web_sg.id]

  user_data = file("userdata.sh")

  tags = {
    Name = "Flask-Express-Server"
  }
}

ğŸ§± Step 3: Outputs (outputs.tf)
output "public_ip" {
  value = aws_instance.app_server.public_ip
}

ğŸ§± Step 4: User Data Script (userdata.sh)

This script installs Python, Flask, Node.js, Express, and starts both apps.

#!/bin/bash
yum update -y

# Install Python & Flask
yum install -y python3
pip3 install flask

# Install Node.js & Express
curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
yum install -y nodejs

# Create Flask App
mkdir -p /opt/flask-app
cat <<EOF > /opt/flask-app/app.py
from flask import Flask
app = Flask(__name__)

@app.route('/')
def hello():
    return "Hello from Flask Backend!"

if __name__ == "__main__":
    app.run(host='0.0.0.0', port=5000)
EOF

# Run Flask app
nohup python3 /opt/flask-app/app.py &

# Create Express App
mkdir -p /opt/express-app
cd /opt/express-app
npm init -y
npm install express

cat <<EOF > index.js
const express = require('express');
const app = express();

app.get('/', (req, res) => {
  res.send('Hello from Express Frontend!');
});

app.listen(3000, () => {
  console.log('Express running on port 3000');
});
EOF

# Run Express app
nohup node index.js &

ğŸš€ Step 5: Deploy with Terraform
terraform init
terraform apply


When prompted:

var.key_name = your-ec2-keypair-name


Confirm with yes.

ğŸŒ Step 6: Access the Applications

After Terraform completes, it will output:

public_ip = xx.xx.xx.xx

Flask Backend
http://<PUBLIC_IP>:5000

Express Frontend
http://<PUBLIC_IP>:3000

ğŸ§ª Expected Output

Flask

Hello from Flask Backend!


Express

Hello from Express Frontend!